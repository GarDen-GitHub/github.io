<!doctype html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"> <!-- ã‚ºãƒ¼ãƒ é˜²æ­¢ -->
  <title>Rasiel Search Mobile - Data</title>
  <style>
    body {
      font-family: sans-serif;
      margin: 0;
      padding: 20px;
    }
    #data-container {
      display: none;
    }
    #update-time {
      text-align: center;
      font-size: 14px;
      color: gray;
      margin-bottom: 10px;
      position: fixed;
      top: 60px;
      left: 0;
      width: 100%;
      background: white;
      z-index: 15;
      padding: 10px 0;
    }
    #table-container {
      max-height: 80vh;
      overflow-y: auto;
      overflow-x: auto;
      min-width: 2770px;
      margin-top: 100px; /* ãƒ˜ãƒƒãƒ€ãƒ¼ã¨æ›´æ–°æ—¥æ™‚ã®é«˜ã•åˆ† */
    }
    table {
      width: 100%;
      border-collapse: collapse;
      display: block;
      table-layout: fixed;
      min-width: 2770px;
    }
    th, td {
      border: 1px solid #ddd;
      padding: 8px;
      text-align: center;
      word-wrap: break-word;
      box-sizing: border-box;
    }
    th {
      background-color: #f2f2f2;
      position: sticky;
      top: 0;
      z-index: 10;
    }
    td.left-align {
      text-align: left;
    }
    th:nth-child(2), th:nth-child(3) {
      text-align: center;
    }
    .gray-row td {
      color: gray;
    }
    button.copy-btn {
      padding: 5px 10px;
      background-color: #007bff;
      color: white;
      border: none;
      border-radius: 5px;
      cursor: pointer;
      font-size: 16px;
    }
    button.copy-btn:hover {
      background-color: #0056b3;
    }
    #loading {
      display: none;
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(255,255,255,0.8);
      text-align: center;
      padding-top: 200px;
      font-size: 18px;
      z-index: 1000;
    }
    #search-loading {
      display: none;
      text-align: center;
      font-size: 14px;
      color: gray;
      margin-top: 10px;
      position: fixed;
      top: 90px;
      left: 0;
      width: 100%;
      z-index: 15;
    }
    /* åˆ—å¹…èª¿æ•´ (pxå˜ä½ã§å›ºå®š) */
    th:nth-child(1), td:nth-child(1) { width: 30px !important; } /* ã‚³ãƒ”ãƒ¼åˆ— */
    th:nth-child(2), td:nth-child(2) { width: 200px !important; } /* åº—èˆ—å */
    th:nth-child(3), td:nth-child(3) { width: 300px !important; } /* ä½æ‰€ */
    th:nth-child(4), td:nth-child(4) { width: 70px !important; } /* På°æ•° */
    th:nth-child(5), td:nth-child(5) { width: 70px !important; } /* Så°æ•° */
    th:nth-child(n+6), td:nth-child(n+6) { width: 100px !important; } /* æ®‹ã‚Šåˆ— (å‡ç­‰å›ºå®š) */
    /* æ¤œç´¢æ©Ÿèƒ½ã®ã‚¹ã‚¿ã‚¤ãƒ« */
    #header-container {
      display: flex;
      align-items: center;
      justify-content: space-between;
      margin-bottom: 10px;
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      background: white;
      z-index: 20;
      padding: 10px 20px;
      box-sizing: border-box;
    }
    #search-container {
      display: flex;
      align-items: center;
    }
    #search-input {
      padding: 8px;
      margin-right: 5px;
      width: 200px;
      font-size: 16px;
    }
    #search-button {
      padding: 8px 12px;
      background-color: #28a745;
      color: white;
      border: none;
      border-radius: 5px;
      cursor: pointer;
    }
    #search-button:hover {
      background-color: #218838;
    }
    /* ãƒ¢ãƒã‚¤ãƒ«å¯¾å¿œ */
    @media (max-width: 600px) {
      body {
        padding: 10px;
      }
      table {
        font-size: 12px;
        table-layout: fixed;
        min-width: 2770px;
      }
      #table-container {
        max-height: 70vh;
        overflow-x: auto;
        min-width: 2770px;
        margin-top: 120px;
      }
      #header-container {
        flex-direction: column;
        align-items: center;
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        padding: 10px;
      }
      #search-container {
        margin-top: 10px;
        justify-content: center;
        width: 100%;
      }
      #search-input {
        width: 70%;
        font-size: 16px;
      }
      #update-time {
        position: fixed;
        top: 80px;
        left: 0;
        width: 100%;
      }
      #search-loading {
        position: fixed;
        top: 110px;
        left: 0;
        width: 100%;
      }
    }
  </style>
</head>
<body>
  <div id="data-container">
    <div id="header-container">
      <h2>Rasiel Search Mobile</h2>
      <div id="search-container">
        <input type="text" id="search-input" placeholder="åº—èˆ—å or ä½æ‰€ã§æ¤œç´¢">
        <button id="search-button" onclick="searchTable()">æ¤œç´¢</button>
      </div>
    </div>
    <p id="update-time"></p> <!-- æ›´æ–°æ—¥æ™‚è¡¨ç¤º -->
    <div id="search-loading">æ¤œç´¢ä¸­...</div> <!-- æ¤œç´¢ä¸­è¡¨ç¤º -->
    <div id="table-container">
      <table id="data-table">
        <thead id="table-head"></thead>
        <tbody id="table-body"></tbody>
      </table>
    </div>
  </div>
  
  <div id="loading">åº—èˆ—ãƒ‡ãƒ¼ã‚¿èª­è¾¼ä¸­...</div> <!-- ãƒ­ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°è¡¨ç¤º -->

  <script>
    let allData = []; // ãƒ‡ãƒ¼ã‚¿å…¨ä½“ã‚’ã‚°ãƒ­ãƒ¼ãƒãƒ«ã«ä¿æŒ
    let currentData = []; // æ¤œç´¢çµæœç”¨ã®ãƒ‡ãƒ¼ã‚¿

    // ãƒ­ã‚°ã‚¤ãƒ³çŠ¶æ…‹ãƒã‚§ãƒƒã‚¯ï¼ˆæœªãƒ­ã‚°ã‚¤ãƒ³ãªã‚‰index.htmlã«æˆ»ã™ï¼‰
 seleccionar
    if (localStorage.getItem('loggedIn') !== 'true') {
      window.location.href = 'index.html';
    } else {
      document.getElementById('data-container').style.display = 'block';
      fetchData();
    }

    // ãƒ‡ãƒ¼ã‚¿å–å¾—ã¨è¡¨ç¤º
    function fetchData() {
      const apiUrl = 'https://script.google.com/macros/s/AKfycbx-8PrH2Sm7zvCyjPFnst4qRE1BkulkQOvpPupBxxRn_vhtNFsznG2rrLMFhZWxUH8VbA/exec';
      
      // ãƒ­ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°è¡¨ç¤º
      document.getElementById('loading').style.display = 'block';
      
      fetch(apiUrl)
        .then(response => {
          if (!response.ok) throw new Error(`HTTP error! status: ${response.status}`);
          return response.json();
        })
        .then(responseData => {
          console.log('Response Data:', responseData); // JSONæ§‹é€ ç¢ºèª
          
          allData = responseData.data || [];
          currentData = [...allData]; // åˆæœŸè¡¨ç¤ºç”¨
          
          let updateTime = responseData.updateTime || 'ä¸æ˜';
          
          // æ›´æ–°æ—¥æ™‚ã®ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆå¤‰æ›´
          if (updateTime !== 'ä¸æ˜') {
            let date;
            if (updateTime.match(/^\d{4}\/\d{2}\/\d{2} \d{2}:\d{2}:\d{2}$/)) {
              date = new Date(updateTime.replace(/\//g, '-')); // JSTæ–‡å­—åˆ—ã‚’Dateã«
            } else if (updateTime.includes('T') && updateTime.endsWith('Z')) {
              date = new Date(updateTime);
              date.setHours(date.getHours()); // UTC to JST
            } else {
              updateTime = 'ä¸æ˜ï¼ˆå½¢å¼ã‚¨ãƒ©ãƒ¼ï¼‰';
            }
            if (date && !isNaN(date)) {
              const year = date.getFullYear();
              const month = String(date.getMonth() + 1).padStart(2, '0');
              const day = String(date.getDate()).padStart(2, '0');
              const hours = String(date.getHours()).padStart(2, '0');
              const minutes = String(date.getMinutes()).padStart(2, '0');
              const seconds = String(date.getSeconds()).padStart(2, '0');
              updateTime = `${year}/${month}/${day} ${hours}:${minutes}:${seconds}`;
            }
          }
          document.getElementById('update-time').innerHTML = `ãƒ‡ãƒ¼ã‚¿æ›´æ–°æ—¥æ™‚: ${updateTime}`;
          
          // ãƒ˜ãƒƒãƒ€ãƒ¼ä½œæˆ (æ”¹è¡Œè¿½åŠ )
          const displayHeaders = [
            '', 'åº—èˆ—å', 'ä½æ‰€', 'På°æ•°', 'Så°æ•°',
            'P-WORLD', 'DMM', 'ã¿ã‚“ãƒ‘ãƒ', 'Maruhan', 'PIA', 'PsCUBE',
            'Site777', 'Pachi\nPICKS', 'Juggler\nOnline', 'DAIDATA\nOnline', 'TERAS\nmobile2',
            'PAPIMO', 'P-moba', 'P-do', 'P-ken', 'P-tora', 'Star', 'Reito',
            'PrimeAI', 'P-ASSiST', 'LINE'
          ];
          let headerRow = '<tr>';
          displayHeaders.forEach(header => {
            headerRow += `<th>${header}</th>`;
          });
          headerRow += '</tr>';
          document.getElementById('table-head').innerHTML = headerRow;
          
          if (allData.length === 0) {
            document.getElementById('table-body').innerHTML = '<tr><td colspan="26">ãƒ‡ãƒ¼ã‚¿ãŒã‚ã‚Šã¾ã›ã‚“ã€‚ (ã‚·ãƒ¼ãƒˆãŒç©ºã§ã™)</td></tr>';
          } else {
            renderTable(currentData);
          }
          
          // ãƒ­ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°éè¡¨ç¤º
          document.getElementById('loading').style.display = 'none';
        })
        .catch(error => {
          console.error('Fetch error:', error.message);
          document.getElementById('table-body').innerHTML = '<tr><td colspan="26">ãƒ‡ãƒ¼ã‚¿ã®å–å¾—ã«å¤±æ•—ã—ã¾ã—ãŸã€‚ (fetchã‚¨ãƒ©ãƒ¼: ' + error.message + ')</td></tr>';
          document.getElementById('loading').style.display = 'none';
        });
    }

    // ãƒ†ãƒ¼ãƒ–ãƒ«æç”»é–¢æ•°
    function renderTable(data) {
      let bodyRows = '';
      data.forEach((row, index) => {
        if (!row || typeof row !== 'object') {
          console.warn(`Invalid row at index ${index}:`, row);
          return;
        }
        
        // Maruhanä»¥é™ã®ã‚­ãƒ¼å®šç¾©
        const dataSiteKeys = [
          'Maruhan_ID', 'PIA_ID', 'PsCUBE_URL', 'Site777_ID', 'PachiPICKS_ID', 'JugglerOnline_ID',
          'DAIDATA_Online_ID', 'TERASmobile2_URL', 'PAPIMO_ID', 'P-moba_URL', 'P-do_ID', 'P-ken_ID',
          'P-tora_ID', 'Star_ID', 'Reito_ID', 'PrimeAI_ID', 'P-ASSiST_URL', 'LINE_ID'
        ];
        
        // Maruhanä»¥é™ã®ãƒ‡ãƒ¼ã‚¿ã‚µã‚¤ãƒˆãŒå­˜åœ¨ã™ã‚‹ã‹ãƒã‚§ãƒƒã‚¯
        let hasDataSite = false;
        let allX = true;
        dataSiteKeys.forEach(key => {
          const value = row[key];
          if (value && value !== '' && value !== '|') {
            hasDataSite = true;
            allX = false;
          }
        });
        
        // è¡Œã®ã‚¯ãƒ©ã‚¹ (ã™ã¹ã¦Ã—ãªã‚‰gray-row)
        const rowClass = !hasDataSite ? ' class="gray-row"' : '';
        
        bodyRows += `<tr${rowClass} data-row-index="${allData.indexOf(row)}">`;
        
        // ã‚³ãƒ”ãƒ¼åˆ—: å­˜åœ¨ã™ã‚‹å ´åˆã®ã¿ãƒœã‚¿ãƒ³
        if (hasDataSite) {
          bodyRows += `<td><button class="copy-btn" onclick="copyRowData(${allData.indexOf(row)})">ğŸ“‹</button></td>`;
        } else {
          bodyRows += '<td></td>';
        }
        
        // åŸºæœ¬åˆ—
        const basicKeys = ['Hall_Name', 'Hall_Address', 'P_Units', 'S_Units'];
        basicKeys.forEach((key, i) => {
          if (!row.hasOwnProperty(key)) {
            console.warn(`Missing key ${key} in row ${index}`);
          }
          bodyRows += `<td${i < 2 ? ' class="left-align"' : ''}>${row[key] != null ? row[key] : ''}</td>`;
        });
        
        // éƒ½é“åºœçœŒãƒ­ãƒ¼ãƒå­—ãƒãƒƒãƒ”ãƒ³ã‚° (DMMç”¨)
        const prefMap = {
          'åŒ—æµ·é“': 'hokkaido', 'é’æ£®çœŒ': 'aomori', 'å²©æ‰‹çœŒ': 'iwate', 'å®®åŸçœŒ': 'miyagi', 'ç§‹ç”°çœŒ': 'akita',
          'å±±å½¢çœŒ': 'yamagata', 'ç¦å³¶çœŒ': 'fukushima', 'èŒ¨åŸçœŒ': 'ibaraki', 'æ ƒæœ¨çœŒ': 'tochigi', 'ç¾¤é¦¬çœŒ': 'gunma',
          'åŸ¼ç‰çœŒ': 'saitama', 'åƒè‘‰çœŒ': 'chiba', 'æ±äº¬éƒ½': 'tokyo', 'ç¥å¥ˆå·çœŒ': 'kanagawa', 'æ–°æ½ŸçœŒ': 'niigata',
          'å¯Œå±±çœŒ': 'toyama', 'çŸ³å·çœŒ': 'ishikawa', 'ç¦äº•çœŒ': 'fukui', 'å±±æ¢¨çœŒ': 'yamanashi', 'é•·é‡çœŒ': 'nagano',
          'å²é˜œçœŒ': 'gifu', 'é™å²¡çœŒ': 'shizuoka', 'æ„›çŸ¥çœŒ': 'aichi', 'ä¸‰é‡çœŒ': 'mie', 'æ»‹è³€çœŒ': 'shiga',
          'äº¬éƒ½åºœ': 'kyoto', 'å¤§é˜ªåºœ': 'osaka', 'å…µåº«çœŒ': 'hyogo', 'å¥ˆè‰¯çœŒ': 'nara', 'å’Œæ­Œå±±çœŒ': 'wakayama',
          'é³¥å–çœŒ': 'tottori', 'å³¶æ ¹çœŒ': 'shimane', 'å²¡å±±çœŒ': 'okayama', 'åºƒå³¶çœŒ': 'hiroshima', 'å±±å£çœŒ': 'yamaguchi',
          'å¾³å³¶çœŒ': 'tokushima', 'é¦™å·çœŒ': 'kagawa', 'æ„›åª›çœŒ': 'ehime', 'é«˜çŸ¥çœŒ': 'kochi', 'ç¦å²¡çœŒ': 'fukuoka',
          'ä½è³€çœŒ': 'saga', 'é•·å´çœŒ': 'nagasaki', 'ç†Šæœ¬çœŒ': 'kumamoto', 'å¤§åˆ†çœŒ': 'oita', 'å®®å´çœŒ': 'miyazaki',
          'é¹¿å…å³¶çœŒ': 'kagoshima', 'æ²–ç¸„çœŒ': 'okinawa'
        };
        
        // ã‚«ã‚¹ã‚¿ãƒ åˆ—
        const customColumns = [
          { key: 'P-WORLD_ID', name: 'P-WORLD', link: value => `https://www.p-world.co.jp/sp/hall.cgi?i=${value}` },
          { key: 'DMM_ID', name: 'DMM', link: (value, address) => {
            value = String(value); // æ•°å€¤ã‚’æ–‡å­—åˆ—ã«å¤‰æ›
            const prefName = (address || '').match(/^([^\d]+?[éƒ½é“åºœçœŒåºœ])/)?.[1] || '';
            const prefRoman = prefMap[prefName] || '';
            return prefRoman ? `https://p-town.dmm.com/shops/${prefRoman}/${value}` : '';
          } },
          { key: 'MinPachi_ID', name: 'ã¿ã‚“ãƒ‘ãƒ', link: value => `https://minpachi.com/${value}/` },
          { key: 'Maruhan_ID', name: 'Maruhan', link: null },
          { key: 'PIA_ID', name: 'PIA', link: null },
          { key: 'PsCUBE_URL', name: 'PsCUBE', link: value => value },
          { key: 'Site777_ID', name: 'Site777', link: value => `https://m.site777.jp/f/D0100.do?pmc=${value}` },
          { key: 'PachiPICKS_ID', name: 'Pachi\nPICKS', link: null },
          { key: 'JugglerOnline_ID', name: 'Juggler\nOnline', link: null },
          { key: 'DAIDATA_Online_ID', name: 'DAIDATA\nOnline', link: value => String(value).includes('@LINE') ? null : `https://daidata.goraggio.com/${value}/` },
          { key: 'TERASmobile2_URL', name: 'TERAS\nmobile2', link: value => value },
          { key: 'PAPIMO_ID', name: 'PAPIMO', link: value => String(value).length === 8 ? `https://papimo.jp/h/${value}/` : null },
          { key: 'P-moba_URL', name: 'P-moba', link: value => value },
          { key: 'P-do_ID', name: 'P-do', link: value => `https://www.p-do.ne.jp/k_mch.cgi?ln=${value}` },
          { key: 'P-ken_ID', name: 'P-ken', link: null },
          { key: 'P-tora_ID', name: 'P-tora', link: value => `https://p-tora.com/smafo/dedamajyoho-P-townDMMpachi/item.html?no=${value}` },
          { key: 'Star_ID', name: 'Star', link: null },
          { key: 'Reito_ID', name: 'Reito', link: value => `https://reitoweb.com/b_moba/doc/news.php?h=${value}` },
          { key: 'PrimeAI_ID', name: 'PrimeAI', link: value => `https://ukyaku.primeai.net/dedamajyoho-P-townDMMpachi/?hcode=${value}` },
          { key: 'P-ASSiST_URL', name: 'P-ASSiST', link: value => value },
          { key: 'LINE_ID', name: 'LINE', link: null }
        ];
        
        customColumns.forEach(col => {
          let value = row[col.key];
          if (value === undefined || value === null || value === '') {
            console.warn(`Missing or empty key ${col.key} in row ${index}`);
            bodyRows += `<td>Ã—</td>`;
          } else {
            value = String(value); // éæ–‡å­—åˆ—ã‚’å¤‰æ›
            if (typeof value !== 'string') {
              console.warn(`Non-string value for key ${col.key} in row ${index}:`, value);
              bodyRows += `<td>Ã—</td>`;
            } else {
              const parts = value.split('|').filter(p => p.trim());
              let display = parts.map(p => {
                let link = col.link ? col.link(p, row['Hall_Address'] || '') : null;
                return link ? `<a href="${link}" target="_blank">âšªï¸</a>` : 'âšªï¸';
              }).join(' ');
              bodyRows += `<td>${display}</td>`;
            }
          }
        });
        
        bodyRows += '</tr>';
      });
      document.getElementById('table-body').innerHTML = bodyRows;
    }

    // æ¤œç´¢æ©Ÿèƒ½ (ãƒœã‚¿ãƒ³ã‚¯ãƒªãƒƒã‚¯ã®ã¿ + æ¤œç´¢ä¸­è¡¨ç¤º + ãƒ‡ãƒãƒƒã‚°ãƒ­ã‚°)
    function searchTable() {
      document.getElementById('search-loading').style.display = 'block'; // æ¤œç´¢ä¸­è¡¨ç¤º
      const query = document.getElementById('search-input').value.toLowerCase().trim();
      if (query === '') {
        currentData = [...allData];
      } else {
        currentData = allData.filter(row => {
          const name = String(row['Hall_Name'] || '').toLowerCase(); // å¼·åˆ¶æ–‡å­—åˆ—å¤‰æ›
          const address = String(row['Hall_Address'] || '').toLowerCase(); // å¼·åˆ¶æ–‡å­—åˆ—å¤‰æ›
          return name.includes(query) || address.includes(query);
        });
      }
      console.log('Search Query:', query, 'Results:', currentData.length); // ãƒ‡ãƒãƒƒã‚°ãƒ­ã‚°
      renderTable(currentData);
      document.getElementById('search-loading').style.display = 'none'; // æ¤œç´¢ä¸­éè¡¨ç¤º
    }

    // ã‚³ãƒ”ãƒ¼æ©Ÿèƒ½ (ã‚¨ãƒ©ãƒ¼é˜²ãå¤‰æ›è¿½åŠ  + ãƒ‡ãƒãƒƒã‚°ãƒ­ã‚°)
    function copyRowData(rowIndex) {
      const row = allData[rowIndex]; // allDataã‚’ä½¿ç”¨
      if (!row) {
        console.error('Invalid row index:', rowIndex); // ãƒ‡ãƒãƒƒã‚°
        alert('è¡Œãƒ‡ãƒ¼ã‚¿ã®å–å¾—ã«å¤±æ•—ã—ã¾ã—ãŸã€‚');
        return;
      }

      const appUrlMap = {
        'PsCUBE_URL': (v) => v,
        'Site777_ID': (v) => `https://m.site777.jp/f/D0100.do?pmc=${v}`,
        'TERASmobile2_URL': (v) => v,
        'P-moba_URL': (v) => v,
        'P-do_ID': (v) => `https://www.p-do.ne.jp/k_mch.cgi?ln=${v}`,
        'P-tora_ID': (v) => `https://p-tora.com/smafo/dedamajyoho-P-townDMMpachi/item.html?no=${v}`,
        'Reito_ID': (v) => `https://reitoweb.com/b_moba/doc/news.php?h=${v}`,
        'PrimeAI_ID': (v) => `https://ukyaku.primeai.net/dedamajyoho-P-townDMMpachi/?hcode=${v}`,
        'P-ASSiST_URL': (v) => v,
        'DAIDATA_Online_ID': (v) => !String(v).endsWith('@LINE') ? `https://daidata.goraggio.com/${v}/` : null, // Stringå¤‰æ›è¿½åŠ 
        'PAPIMO_ID': (v) => /^\d{8}$/.test(String(v)) ? `https://papimo.jp/h/${v}/` : null // Stringå¤‰æ›è¿½åŠ 
      };
      const noLinkKeys = ['Maruhan_ID', 'PIA_ID', 'PachiPICKS_ID', 'JugglerOnline_ID', 'P-ken_ID', 'Star_ID', 'LINE_ID'];

      const dataSiteKeys = [
        'Maruhan_ID', 'PIA_ID', 'PsCUBE_URL', 'Site777_ID', 'PachiPICKS_ID', 'JugglerOnline_ID',
        'DAIDATA_Online_ID', 'TERASmobile2_URL', 'PAPIMO_ID', 'P-moba_URL', 'P-do_ID', 'P-ken_ID',
        'P-tora_ID', 'Star_ID', 'Reito_ID', 'PrimeAI_ID', 'P-ASSiST_URL', 'LINE_ID'
      ];

      let text = `âš«ï¸ ${row['Hall_Name'] || 'ä¸æ˜'}`;
      dataSiteKeys.forEach(appKey => {
        let value = row[appKey] || '';
        value = String(value); // å¼·åˆ¶æ–‡å­—åˆ—å¤‰æ›ï¼ˆã‚¨ãƒ©ãƒ¼é˜²æ­¢ï¼‰
        if (value && value !== '|') {
          const site = appKey.replace('_ID', '').replace('_URL', '').replace('_', ' ');
          const parts = value.split('|').filter(p => p.trim());
          if (parts.length > 0) {
            text += `\nãƒ»${site}`;
            parts.forEach(part => {
              if (noLinkKeys.includes(appKey)) {
                text += `\nID: ${part}`;
              } else if (appUrlMap[appKey]) {
                const url = appUrlMap[appKey](part);
                if (url) {
                  text += `\n${url}`;
                } else {
                  text += `\nID: ${part}`;
                }
              } else {
                text += `\nID: ${part}`;
              }
            });
          }
        }
      });

      navigator.clipboard.writeText(text).then(() => {
        console.log('Copy success for row:', rowIndex); // ãƒ‡ãƒãƒƒã‚°
        alert('ã‚¯ãƒªãƒƒãƒ—ãƒœãƒ¼ãƒ‰ã«æƒ…å ±ã‚’ã‚³ãƒ”ãƒ¼ã—ã¾ã—ãŸ');
      }).catch(err => {
        console.error('Copy failed for row:', rowIndex, err); // ãƒ‡ãƒãƒƒã‚°
        alert('ã‚¯ãƒªãƒƒãƒ—ãƒœãƒ¼ãƒ‰ã¸ã®ã‚³ãƒ”ãƒ¼ã«å¤±æ•—ã—ã¾ã—ãŸ: ' + err.message);
      });
    }
  </script>
</body>
</html>
